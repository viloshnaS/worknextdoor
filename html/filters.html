<!DOCTYPE html>
<html>

<head>

    <title>Work Next Door</title>

    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/filter.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="js/script.js"></script>
	<script src="js/config.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
  <script type="text/javascript" src="js/jquery-ui-1.8.18.custom.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    
</head>

<body>
   
      <table width='100%'>
        <tr>
          <td class="heading">Rate</td>
        </tr>
        <tr>
          <td><button class="rate" id="btn_hourly" value="1">Hourly</button></td>
          <td><button class="rate" id="btn_daily" value="2">Daily</button></td>
          <td><button class="rate" id="btn_monthly" value="3">Monthly</button></td>
          <td><input type="hidden" value="" id="space_rate"/>
        </tr>
      </table>

    <table>
      <tr >
              <td class="div_date_from"  style="display: none;">Date</td>
              <td class="div_date_from"  style="display: none;"><input class="datepicker" id="date_from" type ="date" ></td>
      </tr>
      <tr>
              <td class="div_date_to"  style="display: none;">To</td>
              <td class="div_date_to"  style="display: none;"><input class="datepicker" id="date_to" type ="date" ></td>
      <tr>
              <td class="div_month" style="display: none;">Number of Months</td>
              <td class="div_month" style="display: none;"><input id="month" type ="text" size="3"></td>
            
      </tr>


      <tr>
              <td class="div_time" style="display: none;" >Duration</td>
              <td class="div_time" style="display: none;" >
                  <select id="time_from">
                    <option value="07">07.00</option>
                    <option value="08">08.00</option>
                    <option value="09">09.00</option>
                    <option value="10">10.00</option>
                    <option value="11">11.00</option>
                    <option value="12">12.00</option>
                    <option value="13">13.00</option>
                    <option value="14">14.00</option>
                    <option value="15">15.00</option>
                    <option value="16">16.00</option>
                    <option value="17">17.00</option>
                    <option value="18">18.00</option>
                    <option value="19">19.00</option>
                    <option value="20">20.00</option>
                    <option value="21">21.00</option>
                    <option value="22">22.00</option>
                    <option value="23">23.00</option>
                  </select>
              </td>
      </tr>
      <tr>
              <td class="div_time" style="display: none;" >To</td>
              <td class="div_time" style="display: none;">
                  <select id="time_to">
                    <option value="07">07.00</option>
                    <option value="08">08.00</option>
                    <option value="09">09.00</option>
                    <option value="10">10.00</option>
                    <option value="11">11.00</option>
                    <option value="12">12.00</option>
                    <option value="13">13.00</option>
                    <option value="14">14.00</option>
                    <option value="15">15.00</option>
                    <option value="16">16.00</option>
                    <option value="17">17.00</option>
                    <option value="18">18.00</option>
                    <option value="19">19.00</option>
                    <option value="20">20.00</option>
                    <option value="21">21.00</option>
                    <option value="22">22.00</option>
                    <option value="23">23.00</option>
                  </select>
              </td>
            </tr>
        </table>       

  <hr>

  <table>
    <tr>
      <td class="heading"> Space Type</td>
      <td>
        <select id ="space_type" class="dropdown">
          <option value="">Select</option>
          <option value="1">Desk</option>
          <option value="2">Meeting Room</option>
        </select>
      </td>
      
    </tr>
    <tr>
      <td class="heading"> Capacity</td>
      <td>
        <input type="text" id="capacity" value = "1" size ="7">
      </td>
    </tr>
  </table>

  <hr>
  <p class="heading"> Price </p>

  <div data-role="rangeslider" class="slider">
        
        <input class="slider" type="range" name="price-min" id="price-min" value="0" min="0" max="500">
        
        <input class="slider" type="range" name="price-max" id="price-max" value="1000" min="0" max="1000">
  </div>
  
  <hr>
  <div id="features">
    <table>
      <tr>
        <td class="heading">Features</td>
      </tr>
      <tr>
        <td>Screen</td>
        <td><input type="checkbox" id="screen" value="0"></td>
      </tr>
      <tr>
        <td>Projector</td>
        <td><input type="checkbox" id="projector" value="0"></td>
      </tr>
      <tr>
        <td>Whiteboard</td>
        <td><input type="checkbox" id="whiteboard" value="0"></td>
      </tr>
      <tr>
        <td>WIFI</td>
        <td><input type="checkbox" id="wifi" value="0"></td>
      </tr>
      <tr>
        <td>Printer/Scanner</td>
        <td><input type="checkbox" id="printer_scanner"value="0"></td>
      </tr>
      <tr>
        <td>Parking</td>
        <td><input type="checkbox" id="parking" value="0"></td>
      </tr>
      <tr>
        <td>Kitchen</td>
        <td><input type="checkbox" id="kitchen" value="0"></td>
      </tr>
      <tr>
        <td>Heater</td>
        <td><input type="checkbox" id="heater" value="0"></td>
      </tr>
      <tr>
        <td>Air Con</td>
        <td><input type="checkbox" id="air-con" value="0"></td>
      </tr>

      <tr>
        <td>
          <a id="submit_btn" data-rel="back">Search</a>
        </td>
        

      </tr>

    </table>


  </div>
  <div id="div_results"></div>
</body>

<script>
        $(document).ready(function(){

            initializefilters();


            
          
            $(".rate").click(function(){
                
                var rate= this.value;


                //hourly - show time and hide to calendar
                if(rate==1){ 
                   $(".div_date_from").show();
                   $(".div_time").show();


                   $(".div_date_to").hide();
                   $(".div_month").hide();
                   $("#space_rate" ).val("1");


                }

                //daily - hide time and show to calendar
                else if(rate==2){ 

                  $(".div_date_from").show();
                  $(".div_date_to").show();

                  $(".div_time").hide();
                  $(".div_month").hide();
                
                  $( "#space_rate" ).val("2");


                }

                //monthly - hide time and to calendar - show number of months
                else if(rate ==3){

                  $(".div_date_from").show();
                  $(".div_month").show();
                  
                  
                  $(".div_time").hide();
                  $(".div_date_to").hide();

                  $( "#space_rate" ).val("3");

                }
            });

            $("#space_type").change(function() {
      
                   var value=  $( "#space_type" ).val();
    

                   if(value==1){
                      $( "#capacity" ).val("1");

                      document.getElementById("capacity").disabled = true;
                   }
                   else{
                      document.getElementById("capacity").disabled = false;
                   }
            });

            $("#submit_btn").click(function(){
          
                var space_rate =$( "#space_rate" ).val();

                var date_time_from="";
                var date_time_to="";
                var date_from =$( "#date_from" ).val();
                if(space_rate!="" && date_from ==""){
                    
                    alert("Please select a date");
                    return false;

                }
                if(space_rate==1){
                  
              
                  var time_from =$( "#time_from" ).val();
                  var time_to =$("#time_to" ).val();
                  if(time_to =="" || time_from =="" ){
                    
                    alert("Please select the time");
                    return false;


                  }
                  if(Number(time_to) <= Number(time_from)){
                    
                    alert("Please input a valid time");
                    return false;

                  }
                  date_time_from = date_from+ " "+time_from+":00:00";
                  date_time_to = date_from+ " "+time_to+":00:00";


                }
                else if(space_rate==2){

                  var date_to =$( "#date_to" ).val();
                  if(date_to ==""){
                  
                    alert("Please select the end date");
                    return false;


                  }

                  if(new Date(date_to) < new Date(date_from)){
                    
                    alert("The end date must be greater than start date.");
                    return false;


                  }

                  date_time_from = date_from+ " "+"07:00:00";
                  date_time_to = date_to+ " "+"23:00:00";
                 
                }

                else if(space_rate==3){

                  var duration =$( "#month" ).val();
                  if(duration ==""){
                    
                    alert("Please input a valid duration");
                    return false;
                  }
                  var dateFrom = new Date(date_from);
                  dateFrom.setMonth(dateFrom.getMonth()+ parseInt(duration));
                  var day = dateFrom.getDate();
                  var month= dateFrom.getMonth() + 1;
                  var year= dateFrom.getFullYear();
                  if(month < 10){
                    month = "0"+month;
                  }
                  date_time_from = date_from+ " "+"07:00:00";
                  date_time_to = year+"-"+month+"-"+day+ " "+"23:00:00";
                  

                }
                
                var space_type = $( "#space_type" ).val();
                var capacity = $( "#capacity" ).val();
                var price_min = $( "#price-min" ).val();
                var price_max = $( "#price-max" ).val();
         
                if($("#screen").is(':checked')){
                  var screen = 1;

                }
                else{
                  var screen = 0;
                }

                if($("#wifi").is(':checked')){
                  var wifi = 1;

                }
                else{
                  var wifi = 0;
                }

                if($("#projector").is(':checked')){
                  var projector = 1;

                }
                else{
                  var projector = 0;
                }

                if($("#whiteboard").is(':checked')){
                  var whiteboard = 1;

                }
                else{
                  var whiteboard = 0;
                }

                if($("#kitchen").is(':checked')){

                  var kitchen = 1;

                }
                else{
                  var kitchen = 0;
                }

                if($("#parking").is(':checked')){
                  var parking = 1;

                }
                else{
                  var parking = 0;
                }
                

                if($("#heater").is(':checked')){
                  var heater = 1;

                }
                else{
                  var heater = 0;
                }
                

                if($("#air_con").is(':checked')){
                  var air_con = 1;

                }
                else{
                  var air_con = 0;
                }

                if($("#printer_scanner").is(':checked')){
                  var printer_scanner = 1;

                }
                else{
                  var printer_scanner = 0;
                }
                
      
                  localStorage.setItem("date_from",date_time_from);
                  localStorage.setItem("date_to",date_time_to);
                  localStorage.setItem("duration",$( "#month" ).val());
                  localStorage.setItem("space_rate",space_rate);

                  localStorage.setItem("space_type",space_type);
                  localStorage.setItem("capacity",capacity);
                  localStorage.setItem("price_min",price_min);
                  localStorage.setItem("price_max",price_max);

                  localStorage.setItem("screen",screen);
                  localStorage.setItem("projector",projector);

                  localStorage.setItem("whiteboard",whiteboard);
                  localStorage.setItem("parking",parking);

                  localStorage.setItem("kitchen",kitchen);
                  localStorage.setItem("heater",heater);
                  localStorage.setItem("wifi",wifi);



                  localStorage.setItem("air_con",air_con);
                  localStorage.setItem("printer_scanner",printer_scanner);

                  $.when(initResultList()).done(function(){

                    window.parent.document.getElementById('div_results').innerHTML=$("#div_results").html();
                    $("#div_results").html("");

                    

                  });


                  
            });
        });
    </script>

    <script>
      function initializefilters(){

  

        if(localStorage.getItem("screen") == 1){
          
            $("#screen").prop('checked', true);

        }

        if(localStorage.getItem("projector") == 1){
          
            $("#projector").prop('checked', true);

        }

        if(localStorage.getItem("whiteboard") == 1){
          
            $("#whiteboard").prop('checked', true);

        }

        if(localStorage.getItem("kitchen") == 1){
          
            $("#kitchen").prop('checked', true);

        }

        if(localStorage.getItem("parking") == 1){
          
            $("#parking").prop('checked', true);

        }
        if(localStorage.getItem("heater") == 1){
          
            $("#heater").prop('checked', true);

        }
        if(localStorage.getItem("wifi") == 1){
          
            $("#wifi").prop('checked', true);

        }
        if(localStorage.getItem("air_con") == 1){
          
            $("#air_con").prop('checked', true);

        }
        if(localStorage.getItem("printer_scanner") == 1){
          
            $("#printer_scanner").prop('checked', true);

        }

        $("#price-min").val(localStorage.getItem("price_min"));
        $("#price-max").val(localStorage.getItem("price_max"));

         $("#space_type").val(localStorage.getItem("space_type")).change();
       
        if(localStorage.getItem("space_type")==2){
            $("#capacity").val(localStorage.getItem("capacity"));
         
        }
        else{
           $("#capacity").val("1");
           document.getElementById("capacity").disabled = true;
           

        }

        var rate = localStorage.getItem("space_rate");
        var date_from = localStorage.getItem("date_from");
        var date_to = localStorage.getItem("date_to");
        if(rate ==1){ //hourly
          $(".div_date_from").show();
          $(".div_time").show();
          $("#date_from").val(date_from.substring(0,10));
          $("#time_from").val(date_from.substring(10,13)).change();
          $("#time_to").val(date_to.substring(10,13)).change();
          $("#space_rate" ).val("1");

        }
        else if(rate ==2){
         
          $(".div_date_from").show();
          $(".div_date_to").show();
          $("#date_from").val(date_from.substring(0,10));
          $("#date_to").val(date_to.substring(0,10));
           $( "#space_rate" ).val("2");
        }
        else if(rate==3){

          $(".div_date_from").show();
          $(".div_month").show();
          $("#date_from").val(date_from.substring(0,10));
          $( "#space_rate" ).val("3");
          $( "#duration" ).val(localStorage.getItem("duration"));

          

        }

       
       


    }
               
    </script>

</html>